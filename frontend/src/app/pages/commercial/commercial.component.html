<div class="flex flex-column gap-4 p-4 fadein animation-duration-300">
    <app-page-header 
        title="Comercial" 
        subtitle="Repositorio de documentación comercial y onboarding"
        icon="pi pi-briefcase">
    </app-page-header>
    
    <p-toast></p-toast>
    
    <div class="card p-4 surface-card border-round shadow-2 min-h-[500px]">
        <!-- Toolbar: Breadcrumb + Search + Refresh -->
        <div class="flex flex-column md:flex-row md:align-items-center justify-content-between gap-3 mb-4">
            <div class="flex-1 overflow-hidden">
                <p-breadcrumb [model]="breadcrumbItems()" [home]="homeItem" styleClass="border-none p-0 bg-transparent"></p-breadcrumb>
            </div>
            
            <div class="flex align-items-center gap-2">
                <span class="p-input-icon-left">
                    <p-iconField iconPosition="left">
                        <p-inputIcon styleClass="pi pi-search" />
                        <input pInputText type="text"
                            (input)="onSearch($event)"
                            placeholder="Buscar archivo..." 
                            [ngModel]="searchValue()"/>
                    </p-iconField>
                </span>
                <p-button icon="pi pi-refresh" [rounded]="true" [text]="true" (onClick)="loadFiles()" pTooltip="Recargar"></p-button>
            </div>
        </div>

        <!-- Loading State -->
        <div *ngIf="loading()" class="flex flex-column align-items-center justify-content-center p-6 gap-3">
            <i class="pi pi-spin pi-spinner text-primary" style="font-size: 3rem"></i>
            <span class="text-600">Cargando archivos...</span>
        </div>

        <!-- Content State -->
        <ng-container *ngIf="!loading()">
            <!-- Grid View -->
            <div class="file-grid" *ngIf="filteredFiles().length > 0; else emptyState">
                <div *ngFor="let file of filteredFiles()" class="file-item" (click)="onItemClick(file)">
                    <div class="file-icon-wrapper">
                         <img *ngIf="file.isFolder" src="assets/folder.svg" alt="Folder" class="w-4rem h-4rem">
                         <i *ngIf="!file.isFolder" [class]="getFileIcon(file)"></i>
                    </div>
                    <span class="file-name" [pTooltip]="file.name" tooltipPosition="bottom" [showDelay]="500">{{ file.name }}</span>
                    <span *ngIf="!file.isFolder" class="file-meta">{{ formatSize(file.size) }}</span>
                </div>
            </div>

            <!-- Empty State -->
            <ng-template #emptyState>
                 <div class="flex flex-column align-items-center justify-content-center p-6 gap-3">
                     <i class="pi pi-folder-open text-400" style="font-size: 4rem"></i>
                     <span class="text-500 font-medium text-lg">No se encontraron archivos</span>
                     <span *ngIf="searchValue()" class="text-400">Intenta con otra búsqueda</span>
                 </div>
            </ng-template>
        </ng-container>
    </div>
</div>
